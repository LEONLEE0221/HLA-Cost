<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HLA Chimerism Whole Blood CD19 Cost Chart</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%);
      color: #2c3e50;
      padding: 30px 20px;
      min-height: 100vh;
    }
    .container { max-width: 750px; margin: 0 auto; }
    header { text-align: center; margin-bottom: 30px; }
    h1 { font-size: 28px; font-weight: 700; color: #1a3a6c; margin-bottom: 8px; }
    .subtitle { color: #5a7392; font-size: 16px; }
    .input-section {
      background: white; padding: 24px; border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06); margin-bottom: 30px;
    }
    .form-row { display: flex; align-items: center; margin-bottom: 18px; gap: 16px; flex-wrap: wrap; }
    label { 
      font-weight: 600; color: #2d3748; width: 220px; font-size: 15px; 
      white-space: nowrap;
    }
    input { 
      padding: 10px 14px; border: 1px solid #cbd5e0; border-radius: 8px; 
      font-size: 15px; width: 120px; 
    }
    input:focus { outline: none; border-color: #4299e1; }
    .hint { 
      font-size: 13px; color: #718096; margin-left: 226px; margin-top: 6px;
      line-height: 1.4;
    }
    button {
      background: #2b6cb0; color: white; border: none; padding: 11px 28px;
      border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;
      display: block; margin: 16px auto 0;
    }
    button:hover { background: #2c5282; transform: translateY(-1px); }
    .result-card {
      background: white; border-radius: 12px; box-shadow: 0 6px 16px rgba(0,0,0,0.08);
      padding: 28px; animation: fadeIn 0.4s ease-out;
    }
    @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; } }
    .result-title { font-size:20px; font-weight:700; color:#2d3748; margin-bottom:20px; display:flex; align-items:center; gap:10px; }
    .result-item { display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px dashed #edf2f7; font-size:16px; }
    .result-item:last-child { border-bottom:none; }
    .item-label { display:flex; align-items:center; gap:8px; color:#4a5568; }
    .item-value { font-weight:600; color:#2b6cb0; }
    .total-row { margin-top:16px; padding-top:16px; border-top:2px solid #e2e8f0; }
    .total-label { font-weight:700; color:#2d3748; }
    .total-value { font-weight:800; font-size:22px; color:#c53030; }
    .icon { color: #4299e1; }
    .summary { margin-top: 12px; font-size: 14px; color: #555; line-height: 1.5; }
  </style>
</head>
<body>

  <div class="container">
    <header>
      <h1><i class="fas fa-vial icon"></i> HLA Chimerism Whole Blood CD19 Cost Chart</h1>
      <p class="subtitle">Flexible calculator with customizable sample volume</p>
    </header>

    <div class="input-section">
      <div class="form-row">
        <label for="samples"><i class="fas fa-users"></i> Number of Samples:</label>
        <input type="number" id="samples" value="100" min="1" step="1">
      </div>
      <div class="form-row">
        <label for="volume"><i class="fas fa-flask"></i> Sample Volume per Run (mL):</label>
        <input type="number" id="volume" value="5" min="0.1" step="0.1">
      </div>
      <div class="form-row">
        <label for="repeats"><i class="fas fa-redo"></i> Repeat Times (R):</label>
        <input type="number" id="repeats" value="2" min="0" step="1">
      </div>
      <p class="hint">
        • Each "run" processes one sample of the specified volume.<br>
        • 1 EasySep™ Kit supports up to <strong>60 mL total sample volume</strong>.<br>
        • Filter Tips and Buffer are consumed per run (not per mL).
      </p>
      <button onclick="calculate()">
        <i class="fas fa-calculator"></i> Calculate Cost
      </button>
    </div>

    <div class="result-card" id="output"></div>
  </div>

  <script>
    function calculate() {
      const N = parseFloat(document.getElementById("samples").value) || 0;
      const V = parseFloat(document.getElementById("volume").value) || 0;
      const R = parseInt(document.getElementById("repeats").value) || 0;

      if (N <= 0 || V <= 0) {
        document.getElementById("output").innerHTML = `<p style="color:#e53e3e;">Please enter valid positive values.</p>`;
        return;
      }

      const T = N * (R + 1); // total runs
      const totalVolume = T * V; // total mL processed

      // Costs
      const tipsCost = T * 1124.2;
      const bufferBottles = Math.ceil(20 * T / 250);
      const bufferCost = bufferBottles * 431.2;
      const kitsNeeded = Math.ceil(totalVolume / 60);
      const kitCost = kitsNeeded * 10271.8;
      const totalCost = tipsCost + bufferCost + kitCost;

      const formatter = new Intl.NumberFormat('en-US', {
        minimumFractionDigits: 1,
        maximumFractionDigits: 1
      });

      document.getElementById("output").innerHTML = `
        <div class="result-title">
          <i class="fas fa-chart-line"></i> Cost Breakdown (HKD)
        </div>

        <div class="summary">
          <strong>Summary:</strong> ${formatter.format(N)} samples × ${(R+1)} runs each × ${V} mL = 
          <strong>${formatter.format(totalVolume)} mL</strong> total volume, 
          <strong>${formatter.format(T)} runs</strong>.
        </div>

        <div class="result-item" style="margin-top:16px;">
          <span class="item-label"><i class="fas fa-microchip"></i> RoboSep™ Filter Tips</span>
          <span class="item-value">HKD ${formatter.format(tipsCost)}</span>
        </div>

        <div class="result-item">
          <span class="item-label"><i class="fas fa-tint"></i> RoboSep™ Buffer 1X</span>
          <span class="item-value">HKD ${formatter.format(bufferCost)} (${bufferBottles} bottle${bufferBottles !== 1 ? 's' : ''})</span>
        </div>

        <div class="result-item">
          <span class="item-label"><i class="fas fa-kit-medical"></i> EasySep™ HLA Chimerism Kit</span>
          <span class="item-value">HKD ${formatter.format(kitCost)} (${kitsNeeded} kit${kitsNeeded !== 1 ? 's' : ''})</span>
        </div>

        <div class="result-item total-row">
          <span class="total-label"><i class="fas fa-money-bill-wave"></i> Total Estimated Annual Cost</span>
          <span class="total-value">HKD ${formatter.format(totalCost)}</span>
        </div>

        <div style="margin-top:16px; font-size:14px; color:#666;">
          <i class="fas fa-info-circle"></i> 1 kit capacity = 60 mL. Tips & Buffer consumed per run.
        </div>
      `;
    }

    calculate();
  </script>

</body>
</html>
